# Maintainer: Your Name <your.email@example.com>

pkgname=ryzen-master-commander
pkgver=1.0.0
pkgrel=1
pkgdesc="TDP and fan control for AMD Ryzen processors"
arch=('any')
url="https://github.com/sam1am/Ryzen-Master-Commander"
license=('MIT')
depends=('python' 'python-ttkbootstrap' 'python-matplotlib' 'python-pillow' 'python-pystray')
optdepends=('ryzenadj: for TDP adjustment features'
            'nbfc-linux-git: for fan control features')
makedepends=('python-setuptools')
source=("$pkgname-$pkgver.tar.gz")
sha256sums=('SKIP')
noextract=("$pkgname-$pkgver.tar.gz")  # Add this line

package() {
  # Create a local source directory
  mkdir -p "$srcdir/$pkgname-$pkgver"
  
  # Extract your local archive to the source directory
  tar -xzf "$startdir/$pkgname-$pkgver.tar.gz" -C "$srcdir/$pkgname-$pkgver" --strip-components=1
  
  cd "$srcdir/$pkgname-$pkgver"
  python setup.py install --root="$pkgdir/" --optimize=1
  
  # Install license if you have one
  install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
  
  # Explicitly install polkit policy with correct permissions
  install -Dm644 polkit/com.merrythieves.ryzenadj.policy "$pkgdir/usr/share/polkit-1/actions/com.merrythieves.ryzenadj.policy"
}